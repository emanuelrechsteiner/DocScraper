---
url: https://docs.anthropic.com/en/prompt-library/excel-formula-expert
scraped_at: 2025-05-24T19:49:52.007242
title: Excel formula expert - Anthropic
---

[Anthropic home page![light logo](https://mintlify.s3.us-west-1.amazonaws.com/anthropic/logo/light.svg)![dark logo](https://mintlify.s3.us-west-1.amazonaws.com/anthropic/logo/dark.svg)](https://docs.anthropic.com/)
English
Search...
⌘K
  * [Research](https://www.anthropic.com/research)
  * [News](https://www.anthropic.com/news)
  * [Go to claude.ai](https://claude.ai/)
  * [Go to claude.ai](https://claude.ai/)


Search...
Navigation
Prompt Library
Excel formula expert
[Welcome](https://docs.anthropic.com/en/home)[Developer Guide](https://docs.anthropic.com/en/docs/welcome)[API Guide](https://docs.anthropic.com/en/api/overview)[Claude Code](https://docs.anthropic.com/en/docs/claude-code/overview)[Resources](https://docs.anthropic.com/en/resources/overview)[Release Notes](https://docs.anthropic.com/en/release-notes/overview)
* [Documentation](https://docs.anthropic.com/en/home)
* [Developer Console](https://console.anthropic.com/)
* [Developer Discord](https://www.anthropic.com/discord)
* [Support](https://support.anthropic.com/)
##### Resources
  * [Overview](https://docs.anthropic.com/en/resources/overview)
  * [Quickstarts](https://github.com/anthropics/anthropic-quickstarts)
  * [Claude 3 model card](https://assets.anthropic.com/m/61e7d27f8c8f5919/original/Claude-3-Model-Card.pdf)
  * [Claude 3.7 system card](https://anthropic.com/claude-3-7-sonnet-system-card)
  * [Claude 4 System Card](https://www-cdn.anthropic.com/6be99a52cb68eb70eb9572b4cafad13df32ed995.pdf)
  * [System status](https://status.anthropic.com/)
  * [Anthropic Courses](https://github.com/anthropics/courses)
  * Prompt Library
    * [Prompt Library](https://docs.anthropic.com/en/resources/prompt-library/library)
    * [Cosmic Keystrokes](https://docs.anthropic.com/en/resources/prompt-library/cosmic-keystrokes)
    * [Corporate clairvoyant](https://docs.anthropic.com/en/resources/prompt-library/corporate-clairvoyant)
    * [Website wizard](https://docs.anthropic.com/en/resources/prompt-library/website-wizard)
    * [Excel formula expert](https://docs.anthropic.com/en/resources/prompt-library/excel-formula-expert)
    * [Google apps scripter](https://docs.anthropic.com/en/resources/prompt-library/google-apps-scripter)
    * [Python bug buster](https://docs.anthropic.com/en/resources/prompt-library/python-bug-buster)
    * [Time travel consultant](https://docs.anthropic.com/en/resources/prompt-library/time-travel-consultant)
    * [Storytelling sidekick](https://docs.anthropic.com/en/resources/prompt-library/storytelling-sidekick)
    * [Cite your sources](https://docs.anthropic.com/en/resources/prompt-library/cite-your-sources)
    * [SQL sorcerer](https://docs.anthropic.com/en/resources/prompt-library/sql-sorcerer)
    * [Dream interpreter](https://docs.anthropic.com/en/resources/prompt-library/dream-interpreter)
    * [Pun-dit](https://docs.anthropic.com/en/resources/prompt-library/pun-dit)
    * [Culinary creator](https://docs.anthropic.com/en/resources/prompt-library/culinary-creator)
    * [Portmanteau poet](https://docs.anthropic.com/en/resources/prompt-library/portmanteau-poet)
    * [Hal the humorous helper](https://docs.anthropic.com/en/resources/prompt-library/hal-the-humorous-helper)
    * [LaTeX legend](https://docs.anthropic.com/en/resources/prompt-library/latex-legend)
    * [Mood colorizer](https://docs.anthropic.com/en/resources/prompt-library/mood-colorizer)
    * [Git gud](https://docs.anthropic.com/en/resources/prompt-library/git-gud)
    * [Simile savant](https://docs.anthropic.com/en/resources/prompt-library/simile-savant)
    * [Ethical dilemma navigator](https://docs.anthropic.com/en/resources/prompt-library/ethical-dilemma-navigator)
    * [Meeting scribe](https://docs.anthropic.com/en/resources/prompt-library/meeting-scribe)
    * [Idiom illuminator](https://docs.anthropic.com/en/resources/prompt-library/idiom-illuminator)
    * [Code consultant](https://docs.anthropic.com/en/resources/prompt-library/code-consultant)
    * [Function fabricator](https://docs.anthropic.com/en/resources/prompt-library/function-fabricator)
    * [Neologism creator](https://docs.anthropic.com/en/resources/prompt-library/neologism-creator)
    * [CSV converter](https://docs.anthropic.com/en/resources/prompt-library/csv-converter)
    * [Emoji encoder](https://docs.anthropic.com/en/resources/prompt-library/emoji-encoder)
    * [Prose polisher](https://docs.anthropic.com/en/resources/prompt-library/prose-polisher)
    * [Perspectives ponderer](https://docs.anthropic.com/en/resources/prompt-library/perspectives-ponderer)
    * [Trivia generator](https://docs.anthropic.com/en/resources/prompt-library/trivia-generator)
    * [Mindfulness mentor](https://docs.anthropic.com/en/resources/prompt-library/mindfulness-mentor)
    * [Second-grade simplifier](https://docs.anthropic.com/en/resources/prompt-library/second-grade-simplifier)
    * [VR fitness innovator](https://docs.anthropic.com/en/resources/prompt-library/vr-fitness-innovator)
    * [PII purifier](https://docs.anthropic.com/en/resources/prompt-library/pii-purifier)
    * [Memo maestro](https://docs.anthropic.com/en/resources/prompt-library/memo-maestro)
    * [Career coach](https://docs.anthropic.com/en/resources/prompt-library/career-coach)
    * [Grading guru](https://docs.anthropic.com/en/resources/prompt-library/grading-guru)
    * [Tongue twister](https://docs.anthropic.com/en/resources/prompt-library/tongue-twister)
    * [Interview question crafter](https://docs.anthropic.com/en/resources/prompt-library/interview-question-crafter)
    * [Grammar genie](https://docs.anthropic.com/en/resources/prompt-library/grammar-genie)
    * [Riddle me this](https://docs.anthropic.com/en/resources/prompt-library/riddle-me-this)
    * [Code clarifier](https://docs.anthropic.com/en/resources/prompt-library/code-clarifier)
    * [Alien anthropologist](https://docs.anthropic.com/en/resources/prompt-library/alien-anthropologist)
    * [Data organizer](https://docs.anthropic.com/en/resources/prompt-library/data-organizer)
    * [Brand builder](https://docs.anthropic.com/en/resources/prompt-library/brand-builder)
    * [Efficiency estimator](https://docs.anthropic.com/en/resources/prompt-library/efficiency-estimator)
    * [Review classifier](https://docs.anthropic.com/en/resources/prompt-library/review-classifier)
    * [Direction decoder](https://docs.anthropic.com/en/resources/prompt-library/direction-decoder)
    * [Motivational muse](https://docs.anthropic.com/en/resources/prompt-library/motivational-muse)
    * [Email extractor](https://docs.anthropic.com/en/resources/prompt-library/email-extractor)
    * [Master moderator](https://docs.anthropic.com/en/resources/prompt-library/master-moderator)
    * [Lesson planner](https://docs.anthropic.com/en/resources/prompt-library/lesson-planner)
    * [Socratic sage](https://docs.anthropic.com/en/resources/prompt-library/socratic-sage)
    * [Alliteration alchemist](https://docs.anthropic.com/en/resources/prompt-library/alliteration-alchemist)
    * [Futuristic fashion advisor](https://docs.anthropic.com/en/resources/prompt-library/futuristic-fashion-advisor)
    * [Polyglot superpowers](https://docs.anthropic.com/en/resources/prompt-library/polyglot-superpowers)
    * [Product naming pro](https://docs.anthropic.com/en/resources/prompt-library/product-naming-pro)
    * [Philosophical musings](https://docs.anthropic.com/en/resources/prompt-library/philosophical-musings)
    * [Spreadsheet sorcerer](https://docs.anthropic.com/en/resources/prompt-library/spreadsheet-sorcerer)
    * [Sci-fi scenario simulator](https://docs.anthropic.com/en/resources/prompt-library/sci-fi-scenario-simulator)
    * [Adaptive editor](https://docs.anthropic.com/en/resources/prompt-library/adaptive-editor)
    * [Babel's broadcasts](https://docs.anthropic.com/en/resources/prompt-library/babels-broadcasts)
    * [Tweet tone detector](https://docs.anthropic.com/en/resources/prompt-library/tweet-tone-detector)
    * [Airport code analyst](https://docs.anthropic.com/en/resources/prompt-library/airport-code-analyst)


Prompt Library
# Excel formula expert
Create Excel formulas based on user-described calculations or data manipulations.
> Copy this prompt into our developer [Console](https://console.anthropic.com/dashboard) to try it for yourself!
| Content  
---|---  
System| As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user’s requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.  
User| I have a table with sales data, including the salesperson’s name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the “Electronics” category that occurred in the month of January. Can you help me with the Excel formula to achieve this?  
## 
[​](https://docs.anthropic.com/en/resources/prompt-library/excel-formula-expert#example-output)
Example Output
To calculate the total sales amount for each salesperson based on the given criteria, you can use the following nested Excel formula:
=SUMPRODUCT((A2:A100=A2)(B2:B100=“Electronics”)(MONTH(D2:D100)=1)*(C2:C100))
Explanation: The SUMPRODUCT function in Excel allows you to perform multiple calculations and conditions within a single formula. Here’s how the formula works:
  * (A2:A100=A2) creates an array of TRUE/FALSE values indicating whether each cell in the range A2:A100 matches the salesperson’s name in cell A2.
  * (B2:B100=“Electronics”) creates an array of TRUE/FALSE values indicating whether each cell in the range B2:B100 contains the product category “Electronics”.
  * (MONTH(D2:D100)=1) creates an array of TRUE/FALSE values indicating whether each cell in the range D2:D100 represents a date in the month of January.
  * (C2:C100) is the range containing the sales amounts. The SUMPRODUCT function multiplies the corresponding elements of these arrays and then sums up the results. In this case, it multiplies the TRUE/FALSE values (1 for TRUE, 0 for FALSE) with the sales amounts, effectively summing only the sales that meet all the specified criteria. 
**Tip** : Make sure the ranges A2:A100, B2:B100, C2:C100, and D2:D100 cover all the relevant data in your table. If your data extends beyond row 100, adjust the ranges accordingly. Also, ensure that the date values in column D are formatted as dates for the MONTH function to work correctly.


## 
[​](https://docs.anthropic.com/en/resources/prompt-library/excel-formula-expert#api-request)
API request
  * Python
  * TypeScript
  * AWS Bedrock Python
  * AWS Bedrock TypeScript
  * Vertex AI Python
  * Vertex AI TypeScript


Copy
```
import anthropic
client = anthropic.Anthropic( # defaults to os.environ.get("ANTHROPIC_API_KEY")
  api_key="my_api_key",
)
message = client.messages.create(
  model="claude-opus-4-20250514",
  max_tokens=1000,
  temperature=0,
  system="As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
  messages=[
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": 'I have a table with sales data, including the salesperson\'s name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the "Electronics" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?',
        }
      ],
    }
  ],
)
print(message.content)


```

Copy
```
import anthropic
client = anthropic.Anthropic( # defaults to os.environ.get("ANTHROPIC_API_KEY")
  api_key="my_api_key",
)
message = client.messages.create(
  model="claude-opus-4-20250514",
  max_tokens=1000,
  temperature=0,
  system="As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
  messages=[
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": 'I have a table with sales data, including the salesperson\'s name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the "Electronics" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?',
        }
      ],
    }
  ],
)
print(message.content)


```

Copy
```
import Anthropic from "@anthropic-ai/sdk";
const anthropic = new Anthropic({
 apiKey: "my_api_key", // defaults to process.env["ANTHROPIC_API_KEY"]
});
const msg = await anthropic.messages.create({
 model: "claude-opus-4-20250514",
 max_tokens: 1000,
 temperature: 0,
 system: "As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
 messages: [
  {
   "role": "user",
   "content": [
    {
     "type": "text",
     "text": "I have a table with sales data, including the salesperson's name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the \"Electronics\" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?"
    }
   ]
  }
 ]
});
console.log(msg);

```

Copy
```
from anthropic import AnthropicBedrock
# See https://docs.anthropic.com/claude/reference/claude-on-amazon-bedrock
# for authentication options
client = AnthropicBedrock()
message = client.messages.create(
model="anthropic.claude-opus-4-20250514-v1:0",
max_tokens=1000,
temperature=0,
system="As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
messages=[
{
"role": "user",
"content": [
{
"type": "text",
"text": "I have a table with sales data, including the salesperson's name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the \"Electronics\" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?"
}
]
}
]
)
print(message.content)

```

Copy
```

import AnthropicBedrock from '@anthropic-ai/bedrock-sdk';
// See https://docs.anthropic.com/claude/reference/claude-on-amazon-bedrock
// for authentication options
const client = new AnthropicBedrock();
const msg = await client.messages.create({
model: "anthropic.claude-opus-4-20250514-v1:0",
max_tokens: 1000,
temperature: 0,
system: "As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
messages: [
{
"role": "user",
"content": [
{
"type": "text",
"text": "I have a table with sales data, including the salesperson's name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the \"Electronics\" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?"
}
]
}
]
});
console.log(msg);

```

Copy
```

import { AnthropicVertex } from '@anthropic-ai/vertex-sdk';
// Reads from the `CLOUD_ML_REGION` & `ANTHROPIC_VERTEX_PROJECT_ID` environment variables.
// Additionally goes through the standard `google-auth-library` flow.
const client = new AnthropicVertex();
const msg = await client.messages.create({
model: "claude-3-7-sonnet-v1@20250219",
max_tokens=1000,
temperature=0,
system="As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
messages=[
{
"role": "user",
"content": [
{
"type": "text",
"text": "I have a table with sales data, including the salesperson's name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the \"Electronics\" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?"
}
]
}
]
});
console.log(msg);

```

Copy
```

import { AnthropicVertex } from '@anthropic-ai/vertex-sdk';
// Reads from the `CLOUD_ML_REGION` & `ANTHROPIC_VERTEX_PROJECT_ID` environment variables.
// Additionally goes through the standard `google-auth-library` flow.
const client = new AnthropicVertex();
const msg = await client.messages.create({
model: "claude-3-7-sonnet-v1@20250219",
max_tokens: 1000,
temperature: 0,
system: "As an Excel Formula Expert, your task is to provide advanced Excel formulas that perform the complex calculations or data manipulations described by the user. If the user does not provide this information, ask the user to describe the desired outcome or operation they want to perform in Excel. Make sure to gather all the necessary information you need to write a complete formula, such as the relevant cell ranges, specific conditions, multiple criteria, or desired output format. Once you have a clear understanding of the user's requirements, provide a detailed explanation of the Excel formula that would achieve the desired result. Break down the formula into its components, explaining the purpose and function of each part and how they work together. Additionally, provide any necessary context or tips for using the formula effectively within an Excel worksheet.",
messages: [
{
"role": "user",
"content": [
{
"type": "text",
"text": "I have a table with sales data, including the salesperson's name in column A, the product category in column B, the sales amount in column C, and the date of sale in column D. I want to calculate the total sales amount for each salesperson, but only for sales of products in the \"Electronics\" category that occurred in the month of January. Can you help me with the Excel formula to achieve this?"
}
]
}
]
});
console.log(msg);

```

Was this page helpful?
YesNo
[Website wizard](https://docs.anthropic.com/en/resources/prompt-library/website-wizard)[Google apps scripter](https://docs.anthropic.com/en/resources/prompt-library/google-apps-scripter)
[x](https://x.com/AnthropicAI)[linkedin](https://www.linkedin.com/company/anthropicresearch)
On this page
  * [Example Output](https://docs.anthropic.com/en/resources/prompt-library/excel-formula-expert#example-output)
  * [API request](https://docs.anthropic.com/en/resources/prompt-library/excel-formula-expert#api-request)



